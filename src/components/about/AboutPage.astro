---
import type { LandingContent } from "@/content";

interface AboutPageProps {
  content: LandingContent;
}

const { content } = Astro.props as AboutPageProps;
const lang = content.locale === "ua" ? "uk" : content.locale === "en" ? "en" : "ru";

const containerClass = "mx-auto w-full max-w-6xl px-4 sm:px-6";

const hasHeroParagraphs = content.hero.paragraphs.length > 0;

const reflectionsLinkByLocale = {
  ru: "https://www.alexbon.com/ru/blog/",
  ua: "https://www.alexbon.com/ua/blog/",
  en: "https://www.alexbon.com/en/blog/",
} as const;

const reflectionsLabelByLocale = {
  ru: '"Отражения"',
  ua: '"Відображення"',
  en: '"Reflections"',
} as const;
---

<div lang={lang} class="relative min-h-screen overflow-hidden bg-surface text-strong">
  <main class="relative z-10 flex flex-col gap-6 pb-12 pt-6 sm:gap-8 sm:pt-8">
    {
      hasHeroParagraphs ? (
        <section
          class={`relative isolate overflow-hidden rounded-[2.5rem] border border-soft px-6 py-10 text-center shadow-card section-card ${containerClass} sm:px-10`}
        >
          <div class="relative z-10 flex flex-col items-center gap-6">
            <div class="flex flex-col gap-5 text-center text-[clamp(1.1rem,3vw,1.2rem)] leading-relaxed text-primary md:max-w-4xl">
              {content.hero.paragraphs.map((paragraph) => (
                <p>{paragraph}</p>
              ))}
            </div>
            <div
              class="mx-auto h-px w-20 rounded-full bg-gradient-to-r from-transparent via-[#e7b57f] to-transparent md:mx-0"
              aria-hidden="true"
            />
          </div>
        </section>
      ) : null
    }

    <section
      id="about"
      class={`relative isolate overflow-hidden rounded-[2.25rem] border border-soft px-6 py-10 text-left shadow-card backdrop-blur-sm section-card ${containerClass} flex flex-col gap-8 lg:flex-row lg:items-center sm:px-10`}
    >
      <div
        class="relative z-10 flex flex-1 flex-col gap-6 text-[clamp(1.1rem,3vw,1.2rem)] leading-relaxed text-primary"
      >
        <div class="flex flex-col gap-3">
          <span
            class="badge-soft inline-flex w-fit items-center gap-2 rounded-full px-4 py-1 text-xs font-semibold uppercase tracking-[0.35em] text-muted"
          >
            {content.introduction.heading}
          </span>
          <span
            class="h-px w-16 rounded-full bg-gradient-to-r from-[#d7b48c] via-[#f5d7a4] to-transparent"
            aria-hidden="true"></span>
        </div>
        {
          content.introduction.paragraphs.map((paragraph) => {
            const locale = content.locale as keyof typeof reflectionsLabelByLocale;
            const label = reflectionsLabelByLocale[locale];
            const link = reflectionsLinkByLocale[locale];

            if (label && link && paragraph.includes(label)) {
              const [before, after] = paragraph.split(label);
              return (
                <p>
                  {before}
                  <a href={link} class="text-strong underline-offset-4 hover:underline">
                    {label}
                  </a>
                  {after}
                </p>
              );
            }

            return <p>{paragraph}</p>;
          })
        }
        {
          content.invitation.buttons.length > 0 ? (
            <div class="flex flex-wrap justify-center gap-3 mt-4">
              {content.invitation.buttons.map((button) => (
                <a
                  href={button.href}
                  target="_blank"
                  rel="noreferrer"
                  class="inline-flex items-center justify-center gap-2 rounded-full bg-[#0C0E10] px-5 py-2.5 text-sm font-semibold text-[#F5F5F5] shadow-md transition-all duration-300 hover:-translate-y-0.5 hover:bg-[#1a1d21]"
                >
                  {button.label}
                </a>
              ))}
            </div>
          ) : null
        }
        {
          content.introduction.highlight ? (
            <>
              <span
                class="my-1 h-px w-16 rounded-full bg-gradient-to-r from-transparent via-[#d7b48c] to-transparent"
                aria-hidden="true"
              />
              <div class="flex flex-col gap-4">
                <p class="text-lg font-semibold text-strong">{content.introduction.highlight.title}</p>
                {content.introduction.highlight.paragraphs.map((paragraph) => (
                  <p>{paragraph}</p>
                ))}
              </div>
            </>
          ) : null
        }
      </div>
      <div class="relative z-10 flex flex-1 justify-center">
        <div class="section-card-strong overflow-hidden rounded-[2rem] border border-soft shadow-card">
          <img
            src={content.introduction.image}
            alt={content.introduction.imageAlt}
            width="900"
            height="1350"
            class="h-full w-full object-cover object-center motion-safe:animate-[float_11s_ease-in-out_infinite]"
            loading="lazy"
          />
        </div>
      </div>
    </section>

    <section
      class={`rounded-[2.25rem] border border-soft px-6 py-10 shadow-card backdrop-blur-sm section-card ${containerClass} sm:px-10`}
    >
      <div class="flex flex-col gap-8">
        <div class="flex flex-col items-center gap-4 text-center lg:items-start lg:text-left">
          <h2 class="text-[clamp(2rem,5vw,2.75rem)] font-semibold text-strong">{content.story.heading}</h2>
          <span
            class="h-px w-24 rounded-full bg-gradient-to-r from-transparent via-[rgba(240,186,121,0.5)] to-transparent"
            aria-hidden="true"></span>
        </div>
        <div class="grid gap-8 lg:grid-cols-[minmax(0,1.2fr)_minmax(0,0.9fr)] lg:items-start">
          <div class="grid gap-5">
            {
              content.story.paragraphs.map((paragraph) => (
                <p class="blog-card rounded-[1.75rem] border border-soft bg-surface p-6 text-[clamp(1.1rem,3vw,1.2rem)] leading-relaxed text-primary">
                  {paragraph}
                </p>
              ))
            }
          </div>
          <div class="relative overflow-hidden rounded-[2rem] border border-soft bg-surface/60 shadow-card">
            <img
              src={content.story.image}
              alt={content.story.imageAlt}
              width="960"
              height="1280"
              class="h-full w-full object-cover"
              loading="lazy"
            />
            <div
              class="pointer-events-none absolute inset-0 bg-gradient-to-t from-black/20 via-transparent to-transparent"
              aria-hidden="true"
            >
            </div>
          </div>
        </div>
      </div>
    </section>

    {
      content.locale === "ru" ? (
        <section class={`${containerClass} flex items-center justify-center`}>
          <div class="section-card w-full max-w-3xl overflow-hidden rounded-[2.5rem] border border-soft px-6 py-6 text-center shadow-card">
            <p class="text-base leading-relaxed text-primary sm:text-lg">
              Отзывы о моей работе как психолога можно посмотреть на{" "}
              <a
                href="https://g.page/AlexBon?share"
                target="_blank"
                rel="noopener noreferrer"
                class="text-strong underline-offset-4 hover:underline"
              >
                Google картах &gt;&gt;&gt;
              </a>
            </p>
          </div>
        </section>
      ) : content.locale === "ua" ? (
        <section class={`${containerClass} flex items-center justify-center`}>
          <div class="section-card w-full max-w-3xl overflow-hidden rounded-[2.5rem] border border-soft px-6 py-6 text-center shadow-card">
            <p class="text-base leading-relaxed text-primary sm:text-lg">
              Відгуки про мою роботу як психолога можна подивитися на{" "}
              <a
                href="https://g.page/AlexBon?share"
                target="_blank"
                rel="noopener noreferrer"
                class="text-strong underline-offset-4 hover:underline"
              >
                Google картах &gt;&gt;&gt;
              </a>
            </p>
          </div>
        </section>
      ) : null
    }

    <section class={`${containerClass} flex items-center justify-center`}>
      <div
        class="section-card w-full max-w-3xl overflow-hidden rounded-[2.5rem] border border-soft px-6 py-6 text-center shadow-card"
      >
        <p class="text-base leading-relaxed text-primary sm:text-lg">{content.footerNote}</p>
      </div>
    </section>
  </main>
</div>
